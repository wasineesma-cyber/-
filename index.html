<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="My Finance">
<meta name="theme-color" content="#1a1a3e">
<title>My Second Brain's ‚Äî ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</title>
<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    min-height: 100vh;
    background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3e 50%, #0d0d2b 100%);
    background-attachment: fixed;
    font-family: 'Kanit', 'Noto Sans Thai', sans-serif;
    color: #E8E8F0;
    padding: 24px 16px 48px;
  }

  /* Header */
  header { text-align: center; margin-bottom: 28px; }
  .header-sub {
    font-size: 12px; letter-spacing: 4px;
    color: #6C5CE7; font-weight: 500;
    text-transform: uppercase; margin-bottom: 8px;
  }
  header h1 {
    font-size: 24px; font-weight: 700;
    background: linear-gradient(135deg, #a78bfa, #6C5CE7, #00B894);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    background-clip: text; margin-bottom: 5px;
  }
  header p { color: #555; font-size: 12px; }

  /* Container */
  .container { max-width: 900px; margin: 0 auto; }

  /* Summary Grid */
  .summary-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px; margin-bottom: 22px;
  }
  .card { border-radius: 14px; padding: 14px 10px; text-align: center; }
  .card.income  { background: rgba(0,184,148,0.1);   border: 1px solid rgba(0,184,148,0.25); }
  .card.expense { background: rgba(225,112,85,0.1);  border: 1px solid rgba(225,112,85,0.25); }
  .card.balance { background: rgba(0,184,148,0.1);   border: 1px solid rgba(0,184,148,0.25); }
  .card.balance.negative { background: rgba(225,112,85,0.1); border: 1px solid rgba(225,112,85,0.25); }
  .card.saving  { background: rgba(108,92,231,0.1);  border: 1px solid rgba(108,92,231,0.25); }
  .card-icon   { font-size: 18px; margin-bottom: 4px; }
  .card-label  { font-size: 10px; color: #777; margin-bottom: 4px; }
  .card-value  { font-size: 16px; font-weight: 700; }
  .card.income  .card-value { color: #00B894; }
  .card.expense .card-value { color: #E17055; }
  .card.balance .card-value { color: #00B894; }
  .card.balance.negative .card-value { color: #E17055; }
  .card.saving  .card-value { color: #a78bfa; }

  /* Tabs */
  .tabs {
    display: flex; justify-content: center;
    gap: 6px; margin-bottom: 22px; flex-wrap: wrap;
  }
  .tab-btn {
    padding: 9px 16px; border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.08);
    background: rgba(255,255,255,0.03);
    color: #777; cursor: pointer;
    font-size: 13px; font-weight: 500;
    font-family: inherit; transition: all 0.2s;
  }
  .tab-btn.active {
    border-color: #6C5CE7;
    background: rgba(108,92,231,0.2);
    color: #a78bfa;
  }

  /* Panel */
  .panel { display: none; }
  .panel.active { display: block; }

  /* Glass Card */
  .glass-card {
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.07);
    border-radius: 20px; padding: 22px;
    margin-bottom: 18px;
  }
  .glass-card h3 { font-size: 15px; font-weight: 600; color: #bbb; margin-bottom: 18px; }

  /* Charts */
  .charts-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
  .chart-wrap    { position: relative; height: 260px; }
  .chart-wrap-sm { position: relative; height: 190px; }

  /* Form */
  .form-toggle { display: flex; gap: 8px; margin-bottom: 16px; }
  .type-btn {
    flex: 1; padding: 10px; border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.1);
    background: transparent; color: #666;
    cursor: pointer; font-size: 14px;
    font-weight: 600; font-family: inherit;
    transition: all 0.2s;
  }
  .type-btn.income.active  { border: 2px solid #00B894; background: rgba(0,184,148,0.12); color: #00B894; }
  .type-btn.expense.active { border: 2px solid #E17055; background: rgba(225,112,85,0.12); color: #E17055; }

  .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px; }
  .form-group label { display: block; font-size: 11px; color: #777; margin-bottom: 5px; }
  .form-group input,
  .form-group select {
    width: 100%; padding: 10px 12px;
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.1);
    background: rgba(255,255,255,0.05);
    color: #eee; font-size: 14px;
    font-family: inherit; outline: none;
    transition: border-color 0.2s;
  }
  .form-group select { background: rgba(15,15,35,0.9); }
  .form-group input:focus,
  .form-group select:focus { border-color: #6C5CE7; }
  .form-group input[type="date"]::-webkit-calendar-picker-indicator { filter: invert(0.6); }

  .btn-submit {
    width: 100%; padding: 13px;
    border-radius: 12px; border: none;
    background: linear-gradient(135deg, #6C5CE7, #a78bfa);
    color: white; font-size: 15px; font-weight: 600;
    font-family: inherit; cursor: pointer; transition: opacity 0.2s;
  }
  .btn-submit.income  { background: linear-gradient(135deg, #00B894, #55EFC4); color: #0a2e25; }
  .btn-submit.expense { background: linear-gradient(135deg, #E17055, #FAB1A0); color: #2e0e08; }
  .btn-submit:hover { opacity: 0.88; }

  /* Transaction List */
  .tx-list { display: flex; flex-direction: column; gap: 6px; }
  .tx-item {
    display: flex; align-items: center;
    padding: 11px 14px;
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.05);
    border-radius: 12px; gap: 11px;
  }
  .tx-item.income  { border-left: 3px solid #00B894; }
  .tx-item.expense { border-left: 3px solid #E17055; }
  .tx-icon {
    width: 34px; height: 34px; border-radius: 9px;
    display: flex; align-items: center;
    justify-content: center; font-size: 15px; flex-shrink: 0;
  }
  .tx-item.income  .tx-icon { background: rgba(0,184,148,0.12); }
  .tx-item.expense .tx-icon { background: rgba(225,112,85,0.12); }
  .tx-info { flex: 1; min-width: 0; }
  .tx-desc { font-size: 13px; font-weight: 500; color: #ddd; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .tx-meta { font-size: 11px; color: #555; margin-top: 2px; }
  .tx-amount { font-size: 14px; font-weight: 700; flex-shrink: 0; }
  .tx-item.income  .tx-amount { color: #00B894; }
  .tx-item.expense .tx-amount { color: #E17055; }
  .tx-del {
    width: 26px; height: 26px; border-radius: 7px;
    border: none; background: rgba(255,255,255,0.05);
    color: #555; cursor: pointer; font-size: 11px; flex-shrink: 0;
    transition: all 0.2s;
  }
  .tx-del:hover { background: rgba(225,112,85,0.2); color: #E17055; }

  /* Filter row */
  .filter-row {
    display: flex; align-items: center;
    gap: 10px; margin-bottom: 14px; flex-wrap: wrap;
  }
  .filter-row label { font-size: 12px; color: #777; }
  .filter-row input,
  .filter-row select {
    padding: 7px 11px; border-radius: 9px;
    border: 1px solid rgba(255,255,255,0.1);
    background: rgba(255,255,255,0.05);
    color: #ddd; font-size: 13px;
    font-family: inherit; outline: none;
  }
  .filter-row select { background: rgba(15,15,35,0.9); }
  .filter-row input[type="month"]::-webkit-calendar-picker-indicator { filter: invert(0.6); }

  /* Daily Summary */
  .daily-row {
    padding: 13px 16px;
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.06);
    border-radius: 12px; margin-bottom: 8px;
  }
  .daily-header {
    display: flex; justify-content: space-between;
    align-items: center; margin-bottom: 7px;
  }
  .daily-date  { font-size: 13px; font-weight: 600; color: #a78bfa; }
  .daily-total { font-size: 15px; font-weight: 700; color: #E17055; }
  .daily-items { font-size: 12px; color: #666; line-height: 1.7; }

  /* Analysis */
  .analysis-bar-row { margin-bottom: 13px; }
  .analysis-bar-header {
    display: flex; justify-content: space-between;
    font-size: 13px; color: #bbb; margin-bottom: 5px;
  }
  .analysis-bar-track {
    height: 7px; background: rgba(255,255,255,0.05);
    border-radius: 4px; overflow: hidden;
  }
  .analysis-bar-fill { height: 100%; border-radius: 4px; transition: width 0.6s ease; }

  .income-source-item {
    display: flex; justify-content: space-between;
    align-items: center; padding: 11px 14px;
    margin-bottom: 7px;
    background: rgba(0,184,148,0.06);
    border: 1px solid rgba(0,184,148,0.1);
    border-radius: 11px;
  }
  .income-source-name { font-size: 13px; font-weight: 500; color: #ddd; }
  .income-source-sub  { font-size: 11px; color: #555; margin-top: 2px; }
  .income-source-amount { font-size: 15px; font-weight: 700; color: #00B894; }

  /* Pie legend */
  .pie-legend { display: flex; flex-wrap: wrap; gap: 4px 10px; justify-content: center; margin-top: 10px; }
  .pie-legend-item { display: flex; align-items: center; gap: 4px; font-size: 10px; color: #888; }
  .pie-dot { width: 7px; height: 7px; border-radius: 2px; flex-shrink: 0; }

  /* Tip card */
  .tip-card {
    background: linear-gradient(135deg, rgba(108,92,231,0.08), rgba(0,184,148,0.08));
    border: 1px solid rgba(108,92,231,0.2);
    border-radius: 18px; padding: 22px;
  }
  .tip-card h3 { font-size: 15px; font-weight: 600; color: #a78bfa; margin-bottom: 12px; }
  .tip-card p  { font-size: 13px; line-height: 1.9; color: #aaa; margin-bottom: 6px; }
  .tip-card p:last-child { margin-bottom: 0; }

  /* Empty */
  .empty-state { text-align: center; padding: 40px 20px; color: #444; }
  .empty-state .icon { font-size: 2.2rem; margin-bottom: 10px; }

  /* Toast */
  .toast {
    position: fixed; bottom: 24px; left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: rgba(108,92,231,0.92);
    backdrop-filter: blur(10px);
    color: white; padding: 10px 20px;
    border-radius: 12px; font-size: 14px;
    transition: transform 0.3s ease;
    z-index: 999; white-space: nowrap;
  }
  .toast.show { transform: translateX(-50%) translateY(0); }

  /* Footer */
  footer { text-align: center; margin-top: 36px; font-size: 11px; color: #2a2a4a; }

  /* Settings button */
  .settings-btn {
    position: absolute; right: 16px; top: 50%;
    transform: translateY(-50%);
    background: rgba(255,255,255,0.07); border: 1px solid rgba(255,255,255,0.12);
    color: #aaa; width: 36px; height: 36px;
    border-radius: 10px; font-size: 16px;
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    transition: all 0.2s;
  }
  .settings-btn:hover { background: rgba(108,92,231,0.3); color: #a78bfa; }
  header { position: relative; }

  /* Modal */
  .modal-overlay {
    display: none; position: fixed; inset: 0;
    background: rgba(0,0,0,0.7); backdrop-filter: blur(6px);
    z-index: 2000; align-items: center; justify-content: center; padding: 20px;
  }
  .modal-overlay.open { display: flex; }
  .modal {
    background: #12122a; border: 1px solid rgba(255,255,255,0.1);
    border-radius: 18px; padding: 26px;
    width: 100%; max-width: 440px;
    box-shadow: 0 24px 64px rgba(0,0,0,0.6);
  }
  .modal h3 { font-size: 15px; font-weight: 600; color: #a78bfa; margin-bottom: 18px; }
  .modal label { display: block; font-size: 11px; color: #777; margin-bottom: 5px; margin-top: 12px; }
  .modal input, .modal select {
    width: 100%; padding: 10px 12px;
    border-radius: 10px; border: 1px solid rgba(255,255,255,0.1);
    background: rgba(255,255,255,0.05); color: #eee;
    font-size: 13px; font-family: inherit; outline: none;
    transition: border-color 0.2s;
  }
  .modal select { background: rgba(15,15,35,0.95); }
  .modal input:focus, .modal select:focus { border-color: #6C5CE7; }
  .modal-btns { display: flex; gap: 8px; margin-top: 18px; }
  .modal-btns button {
    flex: 1; padding: 11px; border: none; border-radius: 10px;
    font-size: 14px; font-weight: 600; cursor: pointer; font-family: inherit;
  }
  .btn-save   { background: linear-gradient(135deg,#6C5CE7,#a78bfa); color: white; }
  .btn-cancel { background: rgba(255,255,255,0.07); color: #888; }
  .modal-note { font-size: 11px; color: #555; margin-top: 10px; line-height: 1.6; }

  /* Chat */
  .chat-wrap {
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.06);
    border-radius: 18px; display: flex;
    flex-direction: column; height: 480px; overflow: hidden;
  }
  .chat-messages {
    flex: 1; overflow-y: auto; padding: 16px;
    display: flex; flex-direction: column; gap: 12px;
  }
  .chat-hint {
    text-align: center; color: #444; font-size: 13px;
    padding: 32px 16px; line-height: 1.9;
  }
  .chat-hint strong { color: #6C5CE7; }
  .msg { display: flex; gap: 8px; }
  .msg.user { flex-direction: row-reverse; }
  .msg-bubble {
    max-width: 78%; padding: 10px 14px;
    border-radius: 14px; font-size: 13px; line-height: 1.55;
  }
  .msg.user .msg-bubble { background: linear-gradient(135deg,#6C5CE7,#a78bfa); color: white; border-radius: 14px 14px 4px 14px; }
  .msg.ai   .msg-bubble { background: rgba(255,255,255,0.05); color: #ddd; border-radius: 14px 14px 14px 4px; border: 1px solid rgba(255,255,255,0.07); }
  .msg-avatar { width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; background: rgba(255,255,255,0.06); }

  /* Confirm card */
  .confirm-card { border: 1px solid rgba(108,92,231,0.3); border-radius: 12px; padding: 14px; margin-top: 8px; background: rgba(108,92,231,0.06); }
  .cf-row { display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 13px; }
  .cf-label { color: #666; }
  .cf-val   { font-weight: 600; color: #ddd; }
  .cf-amount.income  { color: #00B894; font-size: 15px; font-weight: 700; }
  .cf-amount.expense { color: #E17055; font-size: 15px; font-weight: 700; }
  .confirm-btns { display: flex; gap: 8px; margin-top: 12px; }
  .confirm-btns button {
    flex: 1; padding: 9px; border: none; border-radius: 9px;
    font-size: 13px; font-weight: 600; cursor: pointer; font-family: inherit;
  }
  .btn-confirm    { background: linear-gradient(135deg,#00B894,#55EFC4); color: #0a2e25; }
  .btn-reject-cf  { background: rgba(255,255,255,0.07); color: #888; }

  /* Chat input */
  .chat-input-row {
    padding: 12px; border-top: 1px solid rgba(255,255,255,0.06);
    display: flex; gap: 8px; align-items: flex-end;
  }
  .chat-input-row textarea {
    flex: 1; padding: 10px 12px; border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.1);
    background: rgba(255,255,255,0.05); color: #eee;
    font-size: 14px; font-family: inherit; resize: none;
    outline: none; min-height: 42px; max-height: 110px;
    transition: border-color 0.2s;
  }
  .chat-input-row textarea:focus { border-color: #6C5CE7; }
  .btn-send {
    width: 42px; height: 42px; border: none; border-radius: 10px;
    background: linear-gradient(135deg,#6C5CE7,#a78bfa);
    color: white; font-size: 16px; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0; transition: opacity 0.2s;
  }
  .btn-send:disabled { opacity: 0.4; }
  .no-key-banner {
    background: rgba(253,203,110,0.08); border: 1px solid rgba(253,203,110,0.2);
    border-radius: 10px; padding: 10px 14px; font-size: 12px; color: #FDCB6E;
    margin-bottom: 12px; display: flex; align-items: center; gap: 8px;
  }
  .no-key-banner button {
    margin-left: auto; padding: 4px 12px; border: none; border-radius: 6px;
    background: #FDCB6E; color: #2d2000; font-size: 12px; font-weight: 600;
    cursor: pointer; font-family: inherit;
  }
  .provider-badge {
    font-size: 11px; color: #555; text-align: center; padding: 6px 0 2px;
  }

  @media (max-width: 620px) {
    .summary-grid { grid-template-columns: repeat(2, 1fr); }
    .charts-grid  { grid-template-columns: 1fr; }
    .form-grid    { grid-template-columns: 1fr; }
    header h1     { font-size: 20px; }
    .chat-wrap    { height: calc(100vh - 340px); min-height: 340px; }
  }
</style>
</head>
<body>

<header>
  <div class="header-sub">üí∞ Financial Dashboard</div>
  <h1>My Second Brain's ‚Äî ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</h1>
  <p>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö-‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à Faye & ‡∏£‡πâ‡∏≤‡∏ô‡∏ß‡∏®‡∏¥‡∏ô‡∏µ</p>
  <button class="settings-btn" onclick="openSettings()" title="‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ AI">‚öôÔ∏è</button>
</header>

<!-- Settings Modal -->
<div class="modal-overlay" id="modalOverlay" onclick="if(event.target===this)closeSettings()">
  <div class="modal">
    <h3>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ AI Provider</h3>
    <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å AI Provider</label>
    <select id="aiProvider" onchange="onProviderChange()">
      <option value="claude">üü£ Claude (Anthropic)</option>
      <option value="openai">üü¢ ChatGPT (OpenAI)</option>
      <option value="gemini">üîµ Gemini (Google)</option>
    </select>
    <label id="keyLabel">API Key</label>
    <input type="password" id="apiKeyInput" placeholder="sk-ant-api03-..." autocomplete="off">
    <p class="modal-note" id="keyNote">
      Claude: ‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å console.anthropic.com ¬∑ OpenAI: platform.openai.com ¬∑ Gemini: aistudio.google.com<br>
      Key ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å provider ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    </p>
    <div class="modal-btns">
      <button class="btn-cancel" onclick="closeSettings()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      <button class="btn-save"   onclick="saveSettings()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
    </div>
  </div>
</div>

<div class="container">

  <!-- Summary Cards -->
  <div class="summary-grid">
    <div class="card income">
      <div class="card-icon">üìà</div>
      <div class="card-label">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏ß‡∏°</div>
      <div class="card-value" id="totalIncome">‡∏ø0</div>
    </div>
    <div class="card expense">
      <div class="card-icon">üìâ</div>
      <div class="card-label">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°</div>
      <div class="card-value" id="totalExpense">‡∏ø0</div>
    </div>
    <div class="card balance" id="cardBalance">
      <div class="card-icon">üíé</div>
      <div class="card-label">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</div>
      <div class="card-value" id="totalBalance">‡∏ø0</div>
    </div>
    <div class="card saving">
      <div class="card-icon">üéØ</div>
      <div class="card-label">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏≠‡∏≠‡∏°</div>
      <div class="card-value" id="savingRate">0%</div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab-btn active" onclick="switchTab('overview')">üìä ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</button>
    <button class="tab-btn" onclick="switchTab('add')">‚ûï ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
    <button class="tab-btn" onclick="switchTab('history')">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
    <button class="tab-btn" onclick="switchTab('daily')">üìÖ ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</button>
    <button class="tab-btn" onclick="switchTab('analysis')">üîç ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
    <button class="tab-btn" onclick="switchTab('ai')">ü§ñ AI</button>
  </div>

  <!-- Panel: Overview -->
  <div class="panel active" id="panel-overview">
    <div class="glass-card">
      <h3>üìä ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö vs ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h3>
      <div class="chart-wrap"><canvas id="chartBar"></canvas></div>
    </div>
    <div class="glass-card">
      <h3>üí∞ ‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏°‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö ‚àí ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢)</h3>
      <div class="chart-wrap" style="height:210px"><canvas id="chartLine"></canvas></div>
    </div>
    <div class="charts-grid">
      <div class="glass-card" style="margin-bottom:0">
        <h3 style="margin-bottom:10px">üìâ ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</h3>
        <div class="chart-wrap-sm"><canvas id="chartPie"></canvas></div>
        <div class="pie-legend" id="pieLegend"></div>
      </div>
      <div class="glass-card" style="margin-bottom:0">
        <h3 style="margin-bottom:10px">üìà ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</h3>
        <div class="chart-wrap-sm"><canvas id="chartPieIncome"></canvas></div>
        <div class="pie-legend" id="pieLegendIncome"></div>
      </div>
    </div>
  </div>

  <!-- Panel: Add Entry -->
  <div class="panel" id="panel-add">
    <div class="glass-card">
      <h3>‚ûï ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</h3>
      <div class="form-toggle">
        <button class="type-btn income active" id="btnIncome" onclick="setType('income')">üìà ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</button>
        <button class="type-btn expense" id="btnExpense" onclick="setType('expense')">üìâ ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</button>
      </div>
      <div class="form-grid">
        <div class="form-group">
          <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
          <input type="date" id="inputDate">
        </div>
        <div class="form-group">
          <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ø)</label>
          <input type="number" id="inputAmount" placeholder="0.00" min="0" step="0.01">
        </div>
        <div class="form-group">
          <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
          <input type="text" id="inputDesc" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô, ‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£...">
        </div>
        <div class="form-group">
          <label>‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</label>
          <select id="inputCategory"></select>
        </div>
      </div>
      <button class="btn-submit income" id="btnSubmit" onclick="addEntry()">‚úì ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</button>
    </div>
  </div>

  <!-- Panel: History -->
  <div class="panel" id="panel-history">
    <div class="filter-row">
      <label>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</label>
      <input type="month" id="filterMonth" onchange="renderHistory()">
      <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</label>
      <select id="filterType" onchange="renderHistory()">
        <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
        <option value="income">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</option>
        <option value="expense">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</option>
      </select>
    </div>
    <div id="txList"></div>
  </div>

  <!-- Panel: Daily Summary -->
  <div class="panel" id="panel-daily">
    <div class="filter-row">
      <label>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:</label>
      <input type="month" id="filterDailyMonth" onchange="renderDaily()">
    </div>
    <div id="dailyList"></div>
  </div>

  <!-- Panel: Analysis -->
  <div class="panel" id="panel-analysis">
    <div class="glass-card">
      <h3>üî• ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</h3>
      <div id="expenseAnalysis"></div>
    </div>
    <div class="glass-card">
      <h3>üíö ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</h3>
      <div id="incomeAnalysis"></div>
    </div>
    <div class="tip-card">
      <h3>üí° ‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</h3>
      <div id="tipContent"></div>
    </div>
  </div>

  <!-- Panel: AI Chat -->
  <div class="panel" id="panel-ai">
    <div id="noKeyBanner" class="no-key-banner" style="display:none">
      ‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API Key
      <button onclick="openSettings()">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
    </div>
    <div class="chat-wrap">
      <div class="chat-messages" id="chatMessages">
        <div class="chat-hint">
          <div style="font-size:2.2rem;margin-bottom:12px">ü§ñ</div>
          ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‡πÄ‡∏ä‡πà‡∏ô<br>
          <strong>"‡∏Å‡∏¥‡∏ô‡∏Ç‡πâ‡∏≤‡∏ß‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô 80 ‡∏ö‡∏≤‡∏ó"</strong><br>
          <strong>"‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô 25000"</strong><br>
          <strong>"‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ 450 ‡∏ö‡∏≤‡∏ó"</strong>
        </div>
      </div>
      <div class="provider-badge" id="providerBadge">Provider: Claude</div>
      <div class="chat-input-row">
        <textarea id="chatInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£..." rows="1"
          onkeydown="if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();sendChat()}"
          oninput="this.style.height='auto';this.style.height=this.scrollHeight+'px'"></textarea>
        <button class="btn-send" id="btnSend" onclick="sendChat()">‚û§</button>
      </div>
    </div>
  </div>

</div>

<div class="toast" id="toast"></div>

<script>
// ---- Data ----
const INCOME_CATS  = ['‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô','‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à Faye','‡∏£‡πâ‡∏≤‡∏ô‡∏ß‡∏®‡∏¥‡∏ô‡∏µ','‡∏ü‡∏£‡∏µ‡πÅ‡∏•‡∏ô‡∏ã‡πå','‡∏≠‡∏∑‡πà‡∏ô‡πÜ'];
const EXPENSE_CATS = ['‡∏≠‡∏≤‡∏´‡∏≤‡∏£','‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á','‡∏ä‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á','‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤/‡∏ö‡πâ‡∏≤‡∏ô','‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à (‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô)','‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û','‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏¥‡∏á','‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥/‡πÑ‡∏ü/‡πÄ‡∏ô‡πá‡∏ï','‡∏≠‡∏∑‡πà‡∏ô‡πÜ'];
const CAT_ICONS = {
  '‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô':'üíº','‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à Faye':'üïØÔ∏è','‡∏£‡πâ‡∏≤‡∏ô‡∏ß‡∏®‡∏¥‡∏ô‡∏µ':'üå∏','‡∏ü‡∏£‡∏µ‡πÅ‡∏•‡∏ô‡∏ã‡πå':'üíª','‡∏≠‡∏∑‡πà‡∏ô‡πÜ':'üì¶',
  '‡∏≠‡∏≤‡∏´‡∏≤‡∏£':'üçú','‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á':'üöå','‡∏ä‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á':'üõçÔ∏è','‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤/‡∏ö‡πâ‡∏≤‡∏ô':'üè†',
  '‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à (‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô)':'üì¶','‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û':'üíä','‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏¥‡∏á':'üéÆ','‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥/‡πÑ‡∏ü/‡πÄ‡∏ô‡πá‡∏ï':'üí°',
  // legacy compat
  '‡∏≠‡∏≤‡∏´‡∏≤‡∏£':'üçú','‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á':'üöå','‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å':'üè†','‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ':'üí°','‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡∏≤‡∏°':'üíÑ',
  '‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á':'üõçÔ∏è','‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤':'üìö','‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô':'üõ°Ô∏è','‡∏Ñ‡πà‡∏≤‡πÅ‡∏≠‡∏õ':'üì±'
};
const PIE_COLORS = ['#6C5CE7','#00B894','#FDCB6E','#E17055','#74B9FF','#A29BFE','#55EFC4','#FAB1A0','#81ECEC'];
const TH_MONTHS  = ['‡∏°.‡∏Ñ.','‡∏Å.‡∏û.','‡∏°‡∏µ.‡∏Ñ.','‡πÄ‡∏°.‡∏¢.','‡∏û.‡∏Ñ.','‡∏°‡∏¥.‡∏¢.','‡∏Å.‡∏Ñ.','‡∏™.‡∏Ñ.','‡∏Å.‡∏¢.','‡∏ï.‡∏Ñ.','‡∏û.‡∏¢.','‡∏ò.‡∏Ñ.'];

let currentType = 'income';
let entries = JSON.parse(localStorage.getItem('expense_entries') || '[]');
let chartBar, chartLine, chartPie, chartPieIncome;

// ---- Migration: move old categories to new ones ----
function migrate() {
  let changed = false;
  const OLD_TO_NEW = {
    '‡∏•‡∏á‡∏ó‡∏∏‡∏ô‡∏£‡πâ‡∏≤‡∏ô Wasinee': '‡∏≠‡∏∑‡πà‡∏ô‡πÜ',
    '‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á': '‡∏ä‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á',
    '‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏π‡∏õ‡πÇ‡∏†‡∏Ñ': '‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥/‡πÑ‡∏ü/‡πÄ‡∏ô‡πá‡∏ï',
  };
  entries = entries.map(e => {
    if (OLD_TO_NEW[e.category]) {
      e.category = OLD_TO_NEW[e.category];
      changed = true;
    }
    return e;
  });
  if (changed) save();
}

// ---- Init ----
function init() {
  migrate();
  const today = new Date();
  document.getElementById('inputDate').value = today.toISOString().slice(0, 10);
  document.getElementById('filterMonth').value = today.toISOString().slice(0, 7);
  document.getElementById('filterDailyMonth').value = today.toISOString().slice(0, 7);
  setType('income');
  updateSummary();
  renderOverview();
}

// ---- Type Toggle ----
function setType(type) {
  currentType = type;
  document.getElementById('btnIncome').classList.toggle('active', type === 'income');
  document.getElementById('btnExpense').classList.toggle('active', type === 'expense');
  const cats = type === 'income' ? INCOME_CATS : EXPENSE_CATS;
  document.getElementById('inputCategory').innerHTML =
    cats.map(c => `<option value="${c}">${CAT_ICONS[c] || ''} ${c}</option>`).join('');
  const btn = document.getElementById('btnSubmit');
  btn.className = 'btn-submit ' + type;
  btn.textContent = type === 'income' ? '‚úì ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö' : '‚úì ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢';
}

// ---- Add Entry ----
function addEntry() {
  const amount = parseFloat(document.getElementById('inputAmount').value);
  const date   = document.getElementById('inputDate').value;
  const category = document.getElementById('inputCategory').value;
  const desc   = document.getElementById('inputDesc').value.trim() || category;
  if (!amount || amount <= 0) { showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô'); return; }
  if (!date) { showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'); return; }
  entries.push({ id: Date.now(), type: currentType, amount, date, category, desc });
  save();
  updateSummary();
  renderOverview();
  document.getElementById('inputAmount').value = '';
  document.getElementById('inputDesc').value = '';
  showToast(currentType === 'income' ? '‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß' : '‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
}

// ---- Delete ----
function deleteEntry(id) {
  entries = entries.filter(e => e.id !== id);
  save();
  updateSummary();
  renderOverview();
  renderHistory();
  renderDaily();
  renderAnalysis();
  showToast('üóëÔ∏è ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß');
}

// ---- Summary Cards ----
function updateSummary() {
  const income  = entries.filter(e => e.type === 'income').reduce((s, e) => s + e.amount, 0);
  const expense = entries.filter(e => e.type === 'expense').reduce((s, e) => s + e.amount, 0);
  const balance = income - expense;
  const rate    = income > 0 ? ((balance / income) * 100).toFixed(1) : 0;
  document.getElementById('totalIncome').textContent  = '‡∏ø' + fmt(income);
  document.getElementById('totalExpense').textContent = '‡∏ø' + fmt(expense);
  document.getElementById('totalBalance').textContent = '‡∏ø' + fmt(Math.abs(balance));
  document.getElementById('savingRate').textContent   = rate + '%';
  document.getElementById('cardBalance').className = 'card balance' + (balance < 0 ? ' negative' : '');
}

// ---- Tabs ----
function switchTab(tab) {
  const tabIds = ['overview','add','history','daily','analysis','ai'];
  document.querySelectorAll('.tab-btn').forEach((b, i) => {
    b.classList.toggle('active', tabIds[i] === tab);
  });
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.getElementById('panel-' + tab).classList.add('active');
  if (tab === 'overview')  renderOverview();
  if (tab === 'history')   renderHistory();
  if (tab === 'daily')     renderDaily();
  if (tab === 'analysis')  renderAnalysis();
  if (tab === 'ai')        initAiPanel();
}

// ---- History ----
function renderHistory() {
  const ym = document.getElementById('filterMonth').value;
  const ft = document.getElementById('filterType').value;
  let data = entries.filter(e => e.date.startsWith(ym));
  if (ft !== 'all') data = data.filter(e => e.type === ft);
  data.sort((a, b) => b.date.localeCompare(a.date) || b.id - a.id);
  const container = document.getElementById('txList');
  if (data.length === 0) {
    container.innerHTML = `<div class="empty-state"><div class="icon">üì≠</div>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</div>`;
    return;
  }
  container.innerHTML = '<div class="tx-list">' + data.map(e => `
    <div class="tx-item ${e.type}">
      <div class="tx-icon">${CAT_ICONS[e.category] || 'üí∞'}</div>
      <div class="tx-info">
        <div class="tx-desc">${esc(e.desc)}</div>
        <div class="tx-meta">${e.category} ¬∑ ${formatDate(e.date)}</div>
      </div>
      <div class="tx-amount">${e.type === 'income' ? '+' : '-'}‡∏ø${fmt(e.amount)}</div>
      <button class="tx-del" onclick="deleteEntry(${e.id})">‚úï</button>
    </div>
  `).join('') + '</div>';
}

// ---- Daily Summary ----
function renderDaily() {
  const ym = document.getElementById('filterDailyMonth').value;
  const data = entries.filter(e => e.type === 'expense' && e.date.startsWith(ym));

  const byDate = {};
  data.forEach(e => {
    if (!byDate[e.date]) byDate[e.date] = { total: 0, items: [] };
    byDate[e.date].total += e.amount;
    byDate[e.date].items.push(e);
  });

  const dates = Object.keys(byDate).sort((a, b) => b.localeCompare(a));
  const container = document.getElementById('dailyList');

  if (dates.length === 0) {
    container.innerHTML = `<div class="empty-state"><div class="icon">üì≠</div>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</div>`;
    return;
  }

  container.innerHTML = dates.map(date => {
    const d = byDate[date];
    const itemsHtml = d.items.map(e =>
      `${CAT_ICONS[e.category] || 'üì¶'} ${esc(e.desc)} <strong style="color:#ddd">‡∏ø${fmt(e.amount)}</strong>`
    ).join('&nbsp;¬∑&nbsp;');
    return `
      <div class="daily-row">
        <div class="daily-header">
          <div class="daily-date">${formatDate(date)}</div>
          <div class="daily-total">-‡∏ø${fmt(d.total)}</div>
        </div>
        <div class="daily-items">${itemsHtml}</div>
      </div>`;
  }).join('');
}

// ---- Analysis ----
function renderAnalysis() {
  const income  = entries.filter(e => e.type === 'income').reduce((s, e) => s + e.amount, 0);
  const expense = entries.filter(e => e.type === 'expense').reduce((s, e) => s + e.amount, 0);
  const balance = income - expense;
  const rate    = income > 0 ? ((balance / income) * 100).toFixed(1) : 0;

  const expMap = {};
  entries.filter(e => e.type === 'expense').forEach(e => { expMap[e.category] = (expMap[e.category] || 0) + e.amount; });
  const expCats = Object.entries(expMap).sort((a, b) => b[1] - a[1]);
  const maxExp  = expCats[0]?.[1] || 1;

  document.getElementById('expenseAnalysis').innerHTML = expCats.length === 0
    ? '<div style="color:#444;text-align:center;padding:20px">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>'
    : expCats.map(([cat, val], i) => `
      <div class="analysis-bar-row">
        <div class="analysis-bar-header">
          <span>${CAT_ICONS[cat] || 'üì¶'} ${cat}</span>
          <span style="color:${PIE_COLORS[i % PIE_COLORS.length]};font-weight:600">‡∏ø${fmt(val)}</span>
        </div>
        <div class="analysis-bar-track">
          <div class="analysis-bar-fill" style="width:${(val/maxExp*100).toFixed(1)}%;background:linear-gradient(90deg,${PIE_COLORS[i % PIE_COLORS.length]},${PIE_COLORS[i % PIE_COLORS.length]}66)"></div>
        </div>
      </div>`).join('');

  const incMap = {};
  entries.filter(e => e.type === 'income').forEach(e => { incMap[e.category] = (incMap[e.category] || 0) + e.amount; });
  const incCats = Object.entries(incMap).sort((a, b) => b[1] - a[1]);

  document.getElementById('incomeAnalysis').innerHTML = incCats.length === 0
    ? '<div style="color:#444;text-align:center;padding:20px">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>'
    : incCats.map(([cat, val]) => `
      <div class="income-source-item">
        <div>
          <div class="income-source-name">${CAT_ICONS[cat] || 'üí∞'} ${cat}</div>
          <div class="income-source-sub">${income > 0 ? ((val/income)*100).toFixed(1) : 0}% ‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
        </div>
        <div class="income-source-amount">‡∏ø${fmt(val)}</div>
      </div>`).join('');

  document.getElementById('tipContent').innerHTML = `
    <p>‚Ä¢ ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏° <span style="color:${parseFloat(rate) >= 20 ? '#00B894' : '#FDCB6E'};font-weight:700">${rate}%</span>
    ${parseFloat(rate) >= 20 ? '‚Äî ‡∏î‡∏µ‡∏°‡∏≤‡∏Å! ‡πÄ‡∏Å‡∏¥‡∏ô 20% ‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ üëè' : '‚Äî ‡∏•‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πâ‡∏≤ 20% ‡∏ô‡∏∞‡∏Ñ‡∏∞'}</p>
    ${expCats[0] ? `<p>‚Ä¢ ‡∏´‡∏°‡∏ß‡∏î‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏¢‡∏≠‡∏∞‡∏™‡∏∏‡∏î: <span style="color:#E17055;font-weight:600">${expCats[0][0]}</span> (‡∏ø${fmt(expCats[0][1])})</p>` : ''}
    ${incCats[0] ? `<p>‚Ä¢ ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏±‡∏Å‡∏°‡∏≤‡∏à‡∏≤‡∏Å: <span style="color:#00B894;font-weight:600">${incCats[0][0]}</span> (${income > 0 ? ((incCats[0][1]/income)*100).toFixed(0) : 0}%)</p>` : ''}
  `;
}

// ---- Charts ----
function renderOverview() {
  renderBarChart();
  renderLineChart();
  renderPieChart();
  renderPieIncomeChart();
  renderAnalysis();
}

function getMonths(n = 6) {
  const months = [], now = new Date();
  for (let i = n-1; i >= 0; i--) {
    const d = new Date(now.getFullYear(), now.getMonth() - i, 1);
    months.push(d.toISOString().slice(0, 7));
  }
  return months;
}

const CHART_DEFAULTS = {
  responsive: true, maintainAspectRatio: false,
  plugins: { tooltip: { callbacks: { label: ctx => ' ‡∏ø' + fmt(ctx.raw) } } }
};

function renderBarChart() {
  const months = getMonths(6);
  const labels  = months.map(m => { const [y, mo] = m.split('-'); return TH_MONTHS[parseInt(mo)-1] + ' ' + (parseInt(y)+543); });
  const incomes  = months.map(m => entries.filter(e => e.type==='income'  && e.date.startsWith(m)).reduce((s,e)=>s+e.amount,0));
  const expenses = months.map(m => entries.filter(e => e.type==='expense' && e.date.startsWith(m)).reduce((s,e)=>s+e.amount,0));
  if (chartBar) chartBar.destroy();
  chartBar = new Chart(document.getElementById('chartBar'), {
    type: 'bar',
    data: { labels, datasets: [
      { label: '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö',  data: incomes,  backgroundColor: 'rgba(0,184,148,0.65)',  borderRadius: 6 },
      { label: '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢', data: expenses, backgroundColor: 'rgba(225,112,85,0.65)', borderRadius: 6 }
    ]},
    options: { ...CHART_DEFAULTS,
      plugins: { ...CHART_DEFAULTS.plugins, legend: { labels: { color: '#888' } } },
      scales: {
        x: { ticks: { color: '#666' }, grid: { color: 'rgba(255,255,255,0.04)' } },
        y: { ticks: { color: '#666', callback: v => '‡∏ø' + (v/1000).toFixed(0) + 'k' }, grid: { color: 'rgba(255,255,255,0.04)' } }
      }
    }
  });
}

function renderLineChart() {
  const months  = getMonths(6);
  const labels  = months.map(m => { const [, mo] = m.split('-'); return TH_MONTHS[parseInt(mo)-1]; });
  const savings = months.map(m => {
    const inc = entries.filter(e => e.type==='income'  && e.date.startsWith(m)).reduce((s,e)=>s+e.amount,0);
    const exp = entries.filter(e => e.type==='expense' && e.date.startsWith(m)).reduce((s,e)=>s+e.amount,0);
    return inc - exp;
  });
  if (chartLine) chartLine.destroy();
  chartLine = new Chart(document.getElementById('chartLine'), {
    type: 'line',
    data: { labels, datasets: [{
      label: '‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡∏≠‡∏°', data: savings,
      borderColor: '#6C5CE7', backgroundColor: 'rgba(108,92,231,0.12)',
      fill: true, tension: 0.4, borderWidth: 3,
      pointBackgroundColor: '#6C5CE7', pointRadius: 6,
      pointBorderColor: '#0d0d2b', pointBorderWidth: 2,
    }]},
    options: { ...CHART_DEFAULTS,
      plugins: { ...CHART_DEFAULTS.plugins, legend: { labels: { color: '#888' } } },
      scales: {
        x: { ticks: { color: '#666' }, grid: { color: 'rgba(255,255,255,0.04)' } },
        y: { ticks: { color: '#666', callback: v => '‡∏ø' + (v/1000).toFixed(0) + 'k' }, grid: { color: 'rgba(255,255,255,0.04)' } }
      }
    }
  });
}

function buildDoughnut(canvasId, legendId, entries, filterType) {
  const ym = new Date().toISOString().slice(0, 7);
  const data = entries.filter(e => e.type === filterType && e.date.startsWith(ym));
  const catMap = {};
  data.forEach(e => { catMap[e.category] = (catMap[e.category] || 0) + e.amount; });
  const cats = Object.keys(catMap), vals = cats.map(c => catMap[c]);
  const legendEl = document.getElementById(legendId);
  if (cats.length === 0) {
    legendEl.innerHTML = '<span style="color:#444;font-size:11px">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</span>';
    return null;
  }
  const chart = new Chart(document.getElementById(canvasId), {
    type: 'doughnut',
    data: { labels: cats, datasets: [{ data: vals, backgroundColor: PIE_COLORS.slice(0, cats.length), borderWidth: 0, hoverBorderWidth: 2 }] },
    options: { ...CHART_DEFAULTS, plugins: { ...CHART_DEFAULTS.plugins, legend: { display: false } } }
  });
  legendEl.innerHTML = cats.map((c, i) =>
    `<div class="pie-legend-item"><div class="pie-dot" style="background:${PIE_COLORS[i % PIE_COLORS.length]}"></div>${c}</div>`
  ).join('');
  return chart;
}

function renderPieChart() {
  if (chartPie) chartPie.destroy();
  chartPie = buildDoughnut('chartPie', 'pieLegend', entries, 'expense');
}

function renderPieIncomeChart() {
  if (chartPieIncome) chartPieIncome.destroy();
  chartPieIncome = buildDoughnut('chartPieIncome', 'pieLegendIncome', entries, 'income');
}

// ---- Settings ----
function getProvider() { return localStorage.getItem('ai_provider') || 'claude'; }
function getApiKey()   { return localStorage.getItem('ai_key_' + getProvider()) || ''; }

function openSettings() {
  const p = getProvider();
  document.getElementById('aiProvider').value = p;
  document.getElementById('apiKeyInput').value = localStorage.getItem('ai_key_' + p) || '';
  onProviderChange();
  document.getElementById('modalOverlay').classList.add('open');
}
function closeSettings() { document.getElementById('modalOverlay').classList.remove('open'); }
function saveSettings() {
  const p   = document.getElementById('aiProvider').value;
  const key = document.getElementById('apiKeyInput').value.trim();
  localStorage.setItem('ai_provider', p);
  if (key) localStorage.setItem('ai_key_' + p, key);
  closeSettings();
  updateProviderBadge();
  checkApiKeyBanner();
  showToast('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß');
}
function onProviderChange() {
  const p = document.getElementById('aiProvider').value;
  const saved = localStorage.getItem('ai_key_' + p) || '';
  document.getElementById('apiKeyInput').value = saved;
  const placeholders = { claude: 'sk-ant-api03-...', openai: 'sk-...', gemini: 'AIzaSy...' };
  document.getElementById('apiKeyInput').placeholder = placeholders[p] || '';
}
function checkApiKeyBanner() {
  document.getElementById('noKeyBanner').style.display = getApiKey() ? 'none' : 'flex';
}
function updateProviderBadge() {
  const names = { claude: 'Claude (Anthropic)', openai: 'ChatGPT (OpenAI)', gemini: 'Gemini (Google)' };
  document.getElementById('providerBadge').textContent = 'Provider: ' + (names[getProvider()] || getProvider());
}
function initAiPanel() {
  checkApiKeyBanner();
  updateProviderBadge();
}

// ---- Chat AI ----
let chatLoading = false;
let msgCounter  = 0;

async function sendChat() {
  if (chatLoading) return;
  const input = document.getElementById('chatInput');
  const text  = input.value.trim();
  if (!text) return;
  const apiKey = getApiKey();
  if (!apiKey) { openSettings(); return; }

  addChatMsg('user', text);
  input.value = '';
  input.style.height = 'auto';
  chatLoading = true;
  document.getElementById('btnSend').disabled = true;
  const loadId = addChatMsg('ai', '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏¥‡∏î...');

  try {
    const today  = new Date().toISOString().slice(0, 10);
    const result = await callAI(apiKey, text, today);
    removeMsg(loadId);
    showConfirmCard(result, text);
  } catch (err) {
    removeMsg(loadId);
    addChatMsg('ai', '‚ùå ' + (err.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'));
  } finally {
    chatLoading = false;
    document.getElementById('btnSend').disabled = false;
  }
}

// ---- Multi-provider API ----
const SYSTEM_PROMPT = (today) => `‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ ${today}
‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©
‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö: ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô, ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à Faye, ‡∏£‡πâ‡∏≤‡∏ô‡∏ß‡∏®‡∏¥‡∏ô‡∏µ, ‡∏ü‡∏£‡∏µ‡πÅ‡∏•‡∏ô‡∏ã‡πå, ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢: ‡∏≠‡∏≤‡∏´‡∏≤‡∏£, ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á, ‡∏ä‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á, ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ä‡πà‡∏≤/‡∏ö‡πâ‡∏≤‡∏ô, ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à (‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô), ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û, ‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏¥‡∏á, ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥/‡πÑ‡∏ü/‡πÄ‡∏ô‡πá‡∏ï, ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡πâ‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏ï‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô JSON: {"type":"income|expense","amount":number,"category":"...","date":"YYYY-MM-DD","description":"..."}`;

const TX_SCHEMA = {
  type: 'object',
  properties: {
    type:        { type: 'string', enum: ['income','expense'] },
    amount:      { type: 'number' },
    category:    { type: 'string' },
    date:        { type: 'string' },
    description: { type: 'string' }
  },
  required: ['type','amount','category','date','description'],
  additionalProperties: false
};

async function callAI(apiKey, userText, today) {
  const provider = getProvider();
  if (provider === 'claude')  return await callClaude(apiKey, userText, today);
  if (provider === 'openai')  return await callOpenAI(apiKey, userText, today);
  if (provider === 'gemini')  return await callGemini(apiKey, userText, today);
  throw new Error('‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å provider: ' + provider);
}

async function callClaude(apiKey, userText, today) {
  const resp = await fetch('https://api.anthropic.com/v1/messages', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'x-api-key': apiKey,
      'anthropic-version': '2023-06-01',
      'anthropic-dangerous-direct-browser-calls': 'true'
    },
    body: JSON.stringify({
      model: 'claude-haiku-4-5-20251001',
      max_tokens: 256,
      system: SYSTEM_PROMPT(today),
      tools: [{ name: 'record_tx', description: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°', input_schema: TX_SCHEMA }],
      tool_choice: { type: 'tool', name: 'record_tx' },
      messages: [{ role: 'user', content: userText }]
    })
  });
  if (!resp.ok) {
    const e = await resp.json().catch(() => ({}));
    if (resp.status === 401) throw new Error('Claude API Key ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
    throw new Error(e?.error?.message || 'Claude HTTP ' + resp.status);
  }
  const data = await resp.json();
  return data.content[0].input;
}

async function callOpenAI(apiKey, userText, today) {
  const resp = await fetch('https://api.openai.com/v1/chat/completions', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': 'Bearer ' + apiKey
    },
    body: JSON.stringify({
      model: 'gpt-4o-mini',
      response_format: { type: 'json_object' },
      messages: [
        { role: 'system', content: SYSTEM_PROMPT(today) },
        { role: 'user',   content: userText }
      ]
    })
  });
  if (!resp.ok) {
    const e = await resp.json().catch(() => ({}));
    if (resp.status === 401) throw new Error('OpenAI API Key ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
    throw new Error(e?.error?.message || 'OpenAI HTTP ' + resp.status);
  }
  const data = await resp.json();
  return JSON.parse(data.choices[0].message.content);
}

async function callGemini(apiKey, userText, today) {
  const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`;
  const resp = await fetch(url, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      contents: [{ role: 'user', parts: [{ text: SYSTEM_PROMPT(today) + '\n\n‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°: ' + userText }] }],
      generationConfig: {
        responseMimeType: 'application/json',
        responseSchema: {
          type: 'OBJECT',
          properties: {
            type:        { type: 'STRING' },
            amount:      { type: 'NUMBER' },
            category:    { type: 'STRING' },
            date:        { type: 'STRING' },
            description: { type: 'STRING' }
          },
          required: ['type','amount','category','date','description']
        }
      }
    })
  });
  if (!resp.ok) {
    const e = await resp.json().catch(() => ({}));
    if (resp.status === 400 || resp.status === 401) throw new Error('Gemini API Key ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
    throw new Error(e?.error?.message || 'Gemini HTTP ' + resp.status);
  }
  const data = await resp.json();
  return JSON.parse(data.candidates[0].content.parts[0].text);
}

function showConfirmCard(result, originalText) {
  const id        = 'cf_' + Date.now();
  const typeLabel = result.type === 'income' ? 'üìà ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö' : 'üìâ ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢';
  const amtClass  = result.type === 'income' ? 'income' : 'expense';
  const sign      = result.type === 'income' ? '+' : '-';
  const html = `
    <div class="confirm-card" id="${id}">
      <div class="cf-row"><span class="cf-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</span><span class="cf-val">${typeLabel}</span></div>
      <div class="cf-row"><span class="cf-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</span><span class="cf-val cf-amount ${amtClass}">${sign}‡∏ø${fmt(result.amount)}</span></div>
      <div class="cf-row"><span class="cf-label">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</span><span class="cf-val">${CAT_ICONS[result.category]||'üì¶'} ${esc(result.category)}</span></div>
      <div class="cf-row"><span class="cf-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</span><span class="cf-val">${formatDate(result.date)}</span></div>
      <div class="cf-row"><span class="cf-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</span><span class="cf-val">${esc(result.description)}</span></div>
      <div class="confirm-btns">
        <button class="btn-confirm"   onclick="confirmEntry(${JSON.stringify(result).replace(/"/g,'&quot;')},'${id}')">‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        <button class="btn-reject-cf" onclick="document.getElementById('${id}').remove()">‚úï ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      </div>
    </div>`;
  addChatMsg('ai', '‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞ ‚ú®', html);
}

function confirmEntry(result, cardId) {
  entries.push({ id: Date.now(), type: result.type, amount: result.amount, date: result.date, category: result.category, desc: result.description });
  save();
  updateSummary();
  renderOverview();
  document.getElementById(cardId)?.remove();
  addChatMsg('ai', '‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß! ‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡πÑ‡∏´‡∏°‡∏Ñ‡∏∞? üòä');
  showToast('‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß');
}

function addChatMsg(role, text, extraHtml = '') {
  const id     = 'msg_' + (++msgCounter);
  const avatar = role === 'user' ? 'üë§' : 'ü§ñ';
  const el     = document.createElement('div');
  el.className = 'msg ' + role;
  el.id        = id;
  el.innerHTML = `<div class="msg-avatar">${avatar}</div><div><div class="msg-bubble">${esc(text)}</div>${extraHtml}</div>`;
  const container = document.getElementById('chatMessages');
  container.querySelector('.chat-hint')?.remove();
  container.appendChild(el);
  container.scrollTop = container.scrollHeight;
  return id;
}
function removeMsg(id) { document.getElementById(id)?.remove(); }

// ---- Helpers ----
function save() { localStorage.setItem('expense_entries', JSON.stringify(entries)); }
function fmt(n) { return Number(n).toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 }); }
function esc(s) { return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
function formatDate(d) {
  const [y, m, day] = d.split('-');
  return parseInt(day) + ' ' + TH_MONTHS[parseInt(m)-1] + ' ' + (parseInt(y)+543);
}
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}

init();
</script>

<footer>My Second Brain's ‚Äî Financial Dashboard ¬∑ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πá‡∏ö‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</footer>

</body>
</html>
